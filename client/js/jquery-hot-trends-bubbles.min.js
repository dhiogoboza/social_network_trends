!function(t){t.fn.hotTrendsBubbles=function(e){function a(t,e){return Math.floor(Math.random()*(e-t+1))+t}function n(t,e){return Math.random()*(e-t+1)+t}var r=t.extend({data:null,key:"name",value:"value",minSize:100},e);return this.each(function(){function e(){var t=u.getContext("2d"),e=u.width,a=u.height;t.clearRect(0,0,e,a);for(var n,r=0;r<s.length;r++)n=s[r],temp=n.x+n.dx,temp<n.radius||temp>n.limitx?n.dx*=-1:n.x=temp,n.y+=n.dy,temp=n.y+n.dy,temp<n.radius||temp>n.limity?n.dy*=-1:n.y=temp,d(t,n)}function i(t,e,a){for(var n,r,i,d=0,l=0;l<s.length;l++)n=a+s[l].radius,r=Math.abs(t-s[l].x),i=Math.abs(e-s[l].y),n>Math.sqrt(r*r+i*i)&&d++;return d}function d(t,e){t.beginPath(),t.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),t.fillStyle="green",t.fill(),t.lineWidth=3,t.strokeStyle="#003300",t.stroke(),t.fillStyle="#FFFFFF",t.fillText(e.text.str,e.x+e.text.x,e.y+e.text.y)}var l,u,h=t(this),s=[];!function(){var o=h.width(),x=h.height(),m=r.data.length,y=.3*(o<x?o:x);l=t("<div/>").addClass("htb-container"),h.empty(),h.append(l);var f=t("<canvas />").attr("id","mainCanvas").attr("width",o).attr("height",x);l.append(f);var v=(u=document.getElementById("mainCanvas")).getContext("2d");v.font="14px Arial";var c,p,g=0;for(c=0;c<m;c++)(p=r.data[c][r.value])>g&&(g=p);var M,b,F,C,S,k,w,I,T,z,B;for(s=[],c=0;c<m;c++){for(p=r.data[c],M=(b=r.minSize+p[r.value]/g*y)/2,S=p[r.key],textMeasure=v.measureText(S),w=999,B=0;B<10&&(T=a(b,o-b),z=a(b,x-b),(I=i(T,z,M))<w&&(w=I,F=T,C=z),0!=I);B++);d(v,k={radius:M,radius2:b,x:F,y:C,limitx:o-M,limity:x-M,dx:n(-.5,.5),dy:n(-.5,.5),text:{str:S,x:-textMeasure.width/2,y:0}}),s.push(k)}setInterval(e,100)}()})}}(jQuery);